â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    Cosmos DB + Monitoring Chart Deployed!                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Application: {{ .Values.appName }}
Namespace:   {{ .Release.Namespace }}
Resource Group: {{ .Values.resourceGroup }}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ—„ï¸  COSMOS DB RESOURCES CREATED:
   â€¢ Account:    {{ include "container-cosmosdb-monitoring.cosmosAccountName" . }}
   â€¢ Database:   {{ .Values.cosmos.databaseName }}
   â€¢ Container:  {{ .Values.cosmos.containerName }}
   â€¢ API:        {{ .Values.cosmos.kind }}

ğŸ”’ SECURITY (Workload Identity):
   â€¢ Managed Identity: {{ include "container-cosmosdb-monitoring.identityName" . }}
   â€¢ Service Account:  {{ include "container-cosmosdb-monitoring.serviceAccountName" . }}
   â€¢ Role: Cosmos DB Built-in Data Contributor

ğŸŒ PRIVATE NETWORKING:
   â€¢ Private Endpoint: {{ include "container-cosmosdb-monitoring.privateEndpointName" . }}
   â€¢ Public Access: Disabled

{{- if .Values.monitoring.enabled }}

ğŸ“Š MONITORING:
   â€¢ Application Insights: {{ include "container-cosmosdb-monitoring.appInsightsName" . }}
   â€¢ Log Analytics:        {{ include "container-cosmosdb-monitoring.workspaceName" . }}
   â€¢ Retention:            {{ .Values.monitoring.retentionDays }} days
   {{- if .Values.monitoring.autoInstrumentation.enabled }}
   â€¢ Auto-Instrumentation: Enabled ({{ .Values.monitoring.autoInstrumentation.language }})
   {{- end }}
{{- end }}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“‹ CHECK RESOURCE STATUS:

  # View all ASO resources
  kubectl get databaseaccounts,sqldatabases,sqldatabasecontainers,privateendpoints,components -n {{ .Release.Namespace }}

  # Check Cosmos DB account status
  kubectl describe databaseaccount {{ include "container-cosmosdb-monitoring.cosmosAccountName" . }} -n {{ .Release.Namespace }}

  # Check Application Insights status
  kubectl describe component {{ include "container-cosmosdb-monitoring.appInsightsName" . }} -n {{ .Release.Namespace }}

  # View deployment logs
  kubectl logs -l app.kubernetes.io/name={{ include "container-cosmosdb-monitoring.name" . }} -n {{ .Release.Namespace }}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ”§ ENVIRONMENT VARIABLES AVAILABLE IN YOUR APP:
   â€¢ COSMOS_ENDPOINT     - Cosmos DB account endpoint
   â€¢ COSMOS_DATABASE     - Database name
   â€¢ COSMOS_CONTAINER    - Container name
   â€¢ AZURE_CLIENT_ID     - Managed identity client ID (for SDK auth)
{{- if .Values.monitoring.enabled }}
   â€¢ APPLICATIONINSIGHTS_CONNECTION_STRING - App Insights connection
   â€¢ OTEL_SERVICE_NAME   - OpenTelemetry service name
{{- end }}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âš ï¸  NOTES:
   â€¢ ASO will take 2-5 minutes to provision Azure resources
   â€¢ The app will restart once ConfigMaps with credentials are ready
   â€¢ Use Azure SDK with DefaultAzureCredential for authentication
   â€¢ Cosmos DB is accessible only via private endpoint

{{- if .Values.monitoring.autoInstrumentation.enabled }}
   â€¢ Auto-instrumentation requires OpenTelemetry Operator installed in cluster
   â€¢ Install with: kubectl apply -f https://github.com/open-telemetry/opentelemetry-operator/releases/latest/download/opentelemetry-operator.yaml
{{- end }}

